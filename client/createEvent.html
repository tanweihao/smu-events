<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <title>Create Event</title>

  <link href="stylesheets/application.css" media="screen" rel="stylesheet" type="text/css" />

  <!--[if lt IE 9]>
<script src="../../javascripts/html5shiv.js" type="text/javascript"></script><script src="../../javascripts/excanvas.js" type="text/javascript"></script><script src="../../javascripts/iefix.js" type="text/javascript"></script><link href="../../stylesheets/iefix.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->

  <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0">
  <link rel='shortcut icon' href='images/favicon.ico' type='image/x-icon'/ > 
  <style>
 
  </style>
</head>
<body>

<div id="modal" class="black-box modal hide fade">
  <div class="modal-header tab-header">
    <button type="button" class="close" data-dismiss="modal">&times;</button>
    <span>Some modal title</span>
  </div>
  <div class="modal-body separator">
    <h4>Text in a modal</h4>
    <p>Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem.</p>
  </div>
  <div class="modal-footer">
    <div class="inner-well">
      <a class="button mini rounded light-gray" data-dismiss="modal">Close</a>
      <a class="button mini rounded blue">Save changes</a>
    </div>
  </div>
</div>

<div id="modal-gallery" class="black-box modal modal-gallery hide fade">
  <div class="modal-header tab-header">
    <button type="button" class="close" data-dismiss="modal">&times;</button>
    <span class="modal-title"></span>
  </div>
  <div class="modal-body"><div class="modal-image"></div></div>
  <div class="modal-footer">
    <div class="pull-left">
      You can also change the images<br/> by scrolling the mouse wheel!
    </div>
    <div class="pull-right">
      <a class="button blue modal-next">Next <i class="icon-arrow-right icon-white"></i></a>
      <a class="button gray modal-prev"><i class="icon-arrow-left icon-white"></i> Previous</a>
      <a class="button green modal-play modal-slideshow" data-slideshow="5000"><i class="icon-play icon-white"></i> Slideshow</a>
      <a class="button black" target="_blank"><i class="icon-download"></i> Download</a>
    </div>
  </div>
</div>
<nav id="primary" class="main-nav">
  <ul>

    <li class="active">
      <a href="#" >
        <i class="icon-dashboard"></i> Organizer
      </a>
    </li>

    <li class="">
      <a href="attendance.html">
        <i class="icon-user"></i> TA
      </a>
    </li>

<li>
          <a href="index.html">
              <i class="icon-off"></i> Log out
          </a>
        </li>



  </ul>
</nav><nav id="secondary" class="main-nav">

  <div class="profile-menu">

    <div class="pull-left">
      <div class="avatar">
        <img src="images/avatar.png" />
      </div>
    </div>

    <div class="pull-left">
      <div class="title">
        Demo
      </div>
      <div class="btn-group">
        <button class="button mini inset black"><i class="icon-cog"></i>  Settings </button>
      </div>
    </div>

    <div class="pull-right profile-menu-nav-collapse">
      <button class="button black"><i class="icon-reorder"></i></button>
    </div>

  </div>

  <ul class="secondary-nav-menu">
  
<li >
  <a href="fullcalendar.html">
      <i class="icon-calendar"></i> Your Events
        </a>
</li>

<li class="active">
  <a href="createEvent.html">
     <i class="icon-plus-sign"></i> Create an event
  </a>
</li>

  </ul>

</nav>



<section id="main">
  <div class="top-nav">
  <div class="container-fluid">
    <div class="row-fluid search-button-bar-container">
      <div class="span12">
        <ul class="breadcrumb">
        <li><a href="#"><i class="icon-home"></i> Organizer</a></li>
          <li class="active"><a href="#">Create an event</a></li>
         </ul>
        <a class="search-button-trigger" href="#"><i class="icon-search"></i></a>
      </div>
    </div>

    <div class="row-fluid search-bar-nav">
      <div class="span12">
        <form>
          <input type="text" class="search" placeholder="Search...">
        </form>
      </div>
    </div>
  </div>
</div>

 <div class="container-fluid">
    <div class="row-fluid">
  <div class="span12">

    <div class="box">
      <div class="tab-header">
        Event Details
        <span class="pull-right">
          <span class="options">
            <a href="#"><i class="icon-cog"></i></a>
          </span>
        </span>
      </div>
     
        <div class="row-fluid">
          <div class="span6">
            <div class="padded">
              <div class="input">
                
                <input name="eventName" type="text" placeholder="Event Name"/>
              </div>
              <div class="input">
              	
                <input name="eventDescription" type="text" placeholder="Event Description"/>
              </div>
              
             <div class="input">
			
              <input name="startDate" id="datetimepicker" type="text" class="span6 fill-up" value="Start Date">
             	
             	  <input name="startTime" id="timepicker" type="text" class="span6 fill-up" value="Start Time">
             	</div>
             <div class="input">
			
              <input name="endDate" id="datetimepicker1" type="text" class="span6 fill-up" value="End Date">
             	
             	 <input name="endTime" id="timepicker1" type="text" class="span6 fill-up" value="End Time">
             	</div>
               <div class="input">
                
                <!--<input name="venue" type="text" placeholder="Venue"/>-->
                <select id="faculty">
  					<option>SIS</option>
  					<option>SOE</option>
  					<option>SOA</option>
 					<option>SOE</option>
				</select>
				<select id="room">
  					<option>SR 2.1</option>
  					<option>SR 3.1</option>
  					<option>SR 4.5</option>
 					<option>SR 5.1</option>
				</select>
				<!--
				<select id="faculty">
  					<option value="SIS">SIS</option>
  					<option value="SOE">SOE</option>
  					<option value="SOA">SOA</option>
 					<option value="SOE">SOE</option>
				</select>
				<select id="room">
  					<option value="SR2.1">SR 2.1</option>
  					<option value="SR3.1">SR 3.1</option>
  					<option value="SR4.1">SR 4.5</option>
 					<option value="SR5.1">SR 5.1</option>
				</select>
				-->
              </div>
              <div class="fileupload-preview">
              		<img class="preview" src="" style="width:200px;height:200px;"/>
              </div>
				<div class="fileupload fileupload-new" data-provides="fileupload">
  <span class="btn btn-file"><span class="fileupload-new"></span><span class="fileupload-exists"></span><input type="file" name="file"/></span>
  <span class="fileupload-preview"></span>
  <a href="#" class="close fileupload-exists" data-dismiss="fileupload" style="float: none"></a>
</div>
            </div>
          </div>

          <div class="span6">

            <div class="padded" style="padding-bottom: 0">
              
              

             
            </div>
          </div>
        </div>
 		<div class="padded">
          <button name="saveEvent"  class="button blue">Save</button>
          <button name="cancelEvent" type="button" class="button">Cancel</button>
		</div>
      
    </div>
  </div>
</div>



    <div class="row-fluid">
  <div class="span12">
    <div class="footer">
      
    </div>
  </div>
</div>
  </div>
</section>

<script type="text/html" id="template-notification">
  <div class="notification animated fadeInLeftMiddle fast{{ item.itemClass }}">
    <div class="left">
      <div style="background-image: url({{ item.imagePath }})" class="{{ item.imageClass }}"></div>
    </div>
    <div class="right">
      <div class="inner">{{ item.text }}</div>
      <div class="time">{{ item.time }}</div>
    </div>

    <i class="icon-remove-sign hide"></i>
  </div>
</script>
<script type="text/html" id="template-notifications">
  <div class="container">
    <div class="row" id="notifications-wrapper">
      <div id="notifications" class="{{ bootstrapPositionClass }} notifications animated">
        <div id="dismiss-all" class="dismiss-all button blue">Dismiss all</div>
        <div id="content">
          <div id="notes"></div>
        </div>
      </div>
    </div>
  </div>
</script>

<script src="javascripts/application.js" type="text/javascript"></script>
<script src="javascripts/jquery.timepicker.min.js" type="text/javascript"></script>
<script src="javascripts/docs.js" type="text/javascript"></script>
<script src="javascripts/docs_charts.js" type="text/javascript"></script>
<script src="javascripts/documentation.js" type="text/javascript"></script>
<script src="javascripts/prettify.js" type="text/javascript"></script>
<link href="stylesheets/prettify.css" media="screen" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    prettyPrint()
</script>

<script type="text/javascript">
   if(readCookie("username")==undefined ||readCookie("username")=="" || readCookie("username")==null ){
            window.location.replace('index.html');
      }else{
          $('.title').text(readCookie("username"));
      }
      
      $('button[name="saveEvent"]').on("click",function(){
      	  var eventName = $('input[name="eventName"]').val();
      	  var eventDescription = $('input[name="eventDescription"]').val();
      	 
      	  var startDate = $('input[name="startDate"]').val();
      	  var startTime = $('input[name="startTime"]').val();
      	  var splitStart = startDate.split("/",3);
      	  var TempStartTime = startTime.substring(0,startTime.length-2);
      	  var splitStartTime = TempStartTime.split(":",2);
      	  var startDateTime = new Date(splitStart[2], splitStart[1], splitStart[0], splitStartTime[0], splitStartTime[1]);
      	 
      	 
      	  var endDate = $('input[name="endDate"]').val();
      	  var endTime = $('input[name="endTime"]').val();
      	  var splitEnd = endDate.split("/",3);
      	  var TempEndTime = endTime.substring(0,endTime.length-2);
      	  var splitEndTime = TempEndTime.split(":",2);
      	  var endDateTime = new Date(splitEnd[2], splitEnd[1], splitEnd[0], splitEndTime[0], splitEndTime[1]);
      	  
      	  var faculty = $( "select#faculty option:selected").val();
      	  var room = $( "select#room option:selected").val();
      	  var venue = faculty + " " + room;
      	  
      	  var image = $('input[name="file"]').val();
      	  
      	  console.log(eventName+" "+eventDescription+" "+startDateTime+" "+endDateTime+" "+faculty+"/"+room+" "+image);
      	  var eventData = '{"event_name":"'+eventName+'","org_name":"'+readCookie("username")+'","org_id":'+readCookie("orgId")+',"start_date":"'+startDateTime+'","end_date":"'+endDateTime+'","venue":"'+venue+'","description":"'+eventDescription+'"}';
      	  $.ajax({
    	    url: "http://smu-events.herokuapp.com/api/events/add_event",
		    type: "POST",
    		contentType: "application/json",
		    data: eventData,
		    error:function(){
		            Notifications.push({
                        text: "<i class='icon-warning-sign'></i>Error : Cannot create event. Please try again.",
                        autoDismiss: 3,
                        "class": "error"
                    });
		    },
    	    success:function(json) {
    	        console.log(json);
    	        if(json.result==-1){
    	            Notifications.push({
                        text: "<i class='icon-warning-sign'></i>Error : Invalid event. Please try again.",
                        autoDismiss: 3,
                        "class": "error"
                    });
    	        }else{
    	            Notifications.push({
                        text: "<i class='icon-success-sign'></i> Successfully created event!",
                        autoDismiss: 3,
                        "class": "success"
                    });
                   window.location.replace('fullcalendar.html');
    	        }
    	        
    	    }
        });
      });
      
      function readURL(input) {

    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('.preview').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
}

$('input[name="file"]').change(function(){
    readURL(this);
});
</script>

</body>
</html>
